#include "hls_stream.h"
#include "ap_axi_sdata.h"


// To be copied over from the software trained ML
const float weights[3][6][32] = {
		{{0.12407916,0.4167104,-0.022583641,-0.06593552,0.2869558,0.28759003,-0.05664568,-0.015478091,0.33422253,-0.20267785,0.20682746,0.14039607,-0.1304471,-0.23810595,-0.051110487,-0.020455813,0.42717928,-0.10081456,-0.044468537,-0.09797797,0.018157946,-0.33175886,-0.11867068,0.018451624,0.11061601,0.35645366,-0.122779384,-0.12640898,0.26324353,0.24283642,0.18497802,0.1982994}
		,{0.12583989,0.26917598,0.08193658,0.3714088,0.13944395,-0.00879171,0.07776805,-0.10375783,0.18654455,-0.37401226,0.27790806,-0.11304909,0.11093844,-0.15131158,-0.27906427,-0.47550705,-0.0064516757,-0.14327477,0.010706541,-0.112084836,0.025913041,-0.035013847,-0.15569653,-0.43514156,0.014966912,0.43475497,0.1326524,0.054713532,0.27428594,-0.01835317,0.18735696,-0.39452484}
		,{-0.10091767,-0.1088547,-0.1362386,0.12046466,0.056930304,0.23587885,-0.18646815,0.43304408,0.2600016,0.2740487,-0.21662244,-0.088357076,0.13944055,0.11566399,0.022020753,0.12795866,-0.27017644,-0.018837566,-0.21858993,-0.1699545,-0.32132643,-0.10207956,-0.17341186,0.20546442,0.14364399,-0.18179457,-0.119247876,0.19778655,0.3256317,-0.24153748,-0.3621668,0.36906803}
		,{0.16414422,-0.17010424,0.09682028,-0.024606528,-0.22822326,-0.07150382,-0.29667377,-0.0672973,-0.015192309,0.19654855,-0.07077074,-0.045465685,0.29301527,0.08665132,-0.57148784,-0.002076376,0.03217411,-0.07554494,-0.093348846,0.011218412,0.0939615,-0.17979048,-0.13753933,0.2068465,0.15715784,0.013055611,-0.24735728,-0.21147971,0.23101099,-0.2140951,0.13245523,-0.24134122}
		,{-0.08900336,-0.09484631,0.27612233,0.48684973,0.18037128,0.052947257,-0.4038868,0.07561243,-0.13193536,-0.21512097,-0.33295268,0.35352015,-0.107918814,-0.38007525,0.22556822,0.15496205,0.11655662,-0.41808817,0.29227686,-0.28779435,-0.01798481,-0.2269758,0.049167752,-0.06918611,-0.17054547,0.114842795,-0.112616405,0.20421208,0.045952924,-0.06415557,0.10002785,0.06468502}
		,{0.24933168,-0.21544117,0.3677775,-0.2651132,-0.318716,-0.16449565,-0.033572905,0.09608963,0.0057432693,0.19901082,-0.45203957,-0.19095755,-0.013062804,0.0017488139,-0.03357796,-0.0355387,-0.14048709,0.1202681,-0.18973489,0.03421429,-0.057710636,-0.02389888,-0.09342857,0.19371144,-0.031433914,-0.014651237,0.2926433,-0.24235183,-0.25530073,0.4589829,-0.120295584,-0.21587466}
		}

		,{{0.045503404,0.3329483,0.0037527797,-0.2840798,-0.09905448,0.027466442,0.2402253,-0.23129798,-0.00083904807,-0.28180248,0.18924786,-0.0963657,-0.008945178,-0.41003332,0.132702,0.010748847,0.18674092,-0.11375807,0.074962795,-0.04618054,0.2394972,-0.09960695,0.18868074,0.11720304,0.09916082,-0.029007826,0.007996828,0.26002532,0.20702183,-0.019984547,-0.12565956,0.124957085}
		,{0.17861319,0.26357976,-0.109592386,0.18604408,0.09294405,0.20721926,-0.21583915,-0.4364523,0.42646733,-0.0838842,-0.07224074,-0.086402275,0.22877462,0.19434726,-0.28214335,-0.7265853,0.17099415,-0.26545087,0.26493365,-0.019628577,0.1751229,0.23005185,-0.17643149,-0.562977,0.0026410695,0.40294033,0.28431675,-0.38675696,-0.025165094,-0.13712953,-0.23617566,0.050133694}
		,{-0.15649618,-0.0024475802,-0.1233105,-0.21505521,0.04240959,-0.03292753,-0.34400618,0.16770801,0.08637406,0.40797466,-0.10354257,0.22052173,0.26791516,0.1768194,-0.112222366,0.26507446,0.183558,0.034773774,-0.20623001,-0.28860515,-0.2063223,0.21035357,-0.3138909,0.12901893,-0.108368166,-0.10344809,0.029995203,-0.12042658,0.4336612,-0.2720293,-0.17114814,0.4356825}
		,{0.3144032,-0.12427192,0.18804315,0.18078478,-0.2548241,0.13442986,-0.19377221,-0.14357843,-0.09864676,0.20997441,-0.024229473,-0.09383558,-0.10227675,0.075899206,-0.5061875,-0.01966842,0.22119813,0.1349931,-0.10597984,0.39565605,0.24415407,0.06052438,0.0039408416,-0.21374094,0.4459256,-0.03162785,-0.3199188,-0.33079618,0.018219765,0.015405871,-0.092013694,0.065293975}
		,{-0.0748972,-0.123211935,-0.0072196885,0.40018505,0.14121847,0.06320847,-0.38620123,0.12358424,-0.20235236,0.13237712,-0.29661226,0.42723536,-0.30517018,-0.2868721,0.0154590225,-0.16971114,0.049648084,-0.4117979,0.23745498,-0.27543944,-0.2658477,-0.16290581,-0.120398976,-0.108513385,-0.0888257,0.3198865,-0.055269126,0.05757151,-0.19487579,-0.124076255,0.112799,-0.17964724}
		,{0.09366427,-0.2728803,0.24908927,-0.028790768,-0.08550923,0.0033235918,-0.06888304,0.26048294,0.063883625,0.07869471,-0.47796804,-0.18236685,-0.08979324,-0.096446976,0.19237585,-0.053606503,0.023044644,0.16412567,-0.2312773,-0.21849985,-0.1355982,-0.040591817,-0.2358287,0.03227885,-0.26722023,0.2845315,0.3128089,0.10588811,-0.08471605,0.4264936,-0.2149275,-0.072528034}
		}

		,{{-0.046723004,0.12764725,0.03198364,-0.22750156,0.27416447,-0.20970005,0.3445357,-0.28943634,-0.053365875,-0.10901395,-0.022711847,-0.038615674,-0.4118037,-0.36931738,-0.17452268,0.27635738,0.1371183,-0.27896392,0.25764266,0.26186606,0.3301204,0.0456254,0.18607028,-0.018123679,0.28007457,0.38244027,0.036817033,-0.00537486,0.0028520206,0.13819574,0.0065914583,0.022507083}
		,{0.043204147,0.121471524,0.31302997,-0.07414821,-0.08648922,0.34710485,-0.13481534,-0.24338086,0.37716976,-0.027983403,-0.07695579,0.06119994,0.39155245,0.04691046,0.07606009,-0.44645035,-0.069822386,0.079048924,0.40216425,0.28375518,-0.06840028,-0.15583882,0.1240116,-0.5606255,0.16278975,0.22695309,0.124752864,-0.46105224,-0.1710413,0.12845616,-0.25480196,-0.24035369}
		,{-0.072926976,-0.0806828,-0.08384789,-0.15241697,-0.021160712,0.20277753,-0.21110253,0.22776411,-0.15081576,0.35586548,-0.24957936,-0.16581471,0.13602367,0.08978704,-0.2907379,0.28664073,-0.09144152,0.11955246,0.057355374,-0.35730302,-0.33272734,0.31362545,-0.46592066,-0.021391788,-0.19954066,-0.28281143,-0.16027372,0.02455973,0.5422498,-0.24491243,-0.2648859,0.22292508}
		,{0.29335684,-0.19607288,0.24057095,-0.15257293,-0.21314198,-0.10104235,-0.12831958,-0.18326621,0.15446319,0.23676103,0.1248662,0.18541127,-0.09740874,-0.119142,-0.26483124,0.09496277,-0.17499521,0.10785236,0.1661521,0.39465737,0.17501543,-0.34851864,-0.0947103,0.16097735,0.36438453,0.26012734,-0.38408306,0.10306959,0.15600282,0.0116955405,0.054732766,-0.10702302}
		,{0.20735446,0.023241065,0.3709424,0.36816654,0.04843679,0.17161511,-0.3218743,-0.09723458,-0.02826548,-0.03662923,0.07389594,0.10038,-0.16419096,-0.011710373,-0.13911147,0.04878355,0.03373761,-0.46167052,0.08022636,-0.3317658,-0.15276928,-0.2422292,-0.22454043,0.25670516,0.2382131,0.07671543,0.027021559,0.14639576,-0.1784853,0.020886948,0.050610244,0.05920429}
		,{-0.0081859855,-0.07887597,0.18473472,-0.22288083,0.102821946,-0.019726465,0.13999845,0.11829708,0.01922121,0.35032713,-0.36928672,-0.23892514,-0.05844091,-0.057331827,-0.07769104,0.004161086,-0.01298896,-0.046051167,0.0044978024,0.028439632,-0.31804097,0.11371161,0.13822131,0.2798769,-0.22393243,0.23564284,0.056185335,-0.038710836,-0.11173429,0.3844596,-0.16066085,0.20348659}
		}

		};

const float bias[32] = {0.035375703,-0.19768223,0.23696046,-0.08634397,0.23429859,0.41108948,-0.14533375,0.026608804,-0.018689808,0.17717828,0.0014129122,-0.2062338,0.09368551,0.23741323,0.13176642,0.22237474,0.29940712,0.09896378,-0.2213581,-0.049851894,-0.04547032,-0.0362248,0.12868795,-0.024271563,0.09256512,0.24001648,0.12501486,-0.1983246,0.18258372,0.011999082,0.010859727,0.26037523};

float relu(float inp);

typedef hls::axis<float,1,1,1> floating_point;

void conv_layer_1(hls::stream<floating_point>& input_vector,  hls::stream<floating_point>& output_vector);